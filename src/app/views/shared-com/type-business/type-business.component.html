<c-row ngPreserveWhitespaces>
  <!--<c-col xs="12">
  </c-col>
  <c-col xs="6">
    <c-card class="mb-4">
      <c-card-header>
        <strong>Angular Select</strong> <small>Default</small>
      </c-card-header>
      <c-card-body>
        <app-select-parameters [parameterList]="listTypes" (onRowChange)="selectUser($event)"></app-select-parameters>
      </c-card-body>
    </c-card>
  </c-col>
  <c-col xs="6">
    <c-card class="mb-4">
      <c-card-header>
        <strong>Angular Select</strong> <small>Default 2</small>
      </c-card-header>
      <c-card-body>
        <app-select-parameters [parameterList]="listTypes" (onRowChange)="selectUser($event)"></app-select-parameters>

      </c-card-body>
    </c-card>
  </c-col>-->

  <c-col xs="12">
    <c-card class="mb-12">
      <c-card-header class="mb-3">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-12">
              <div class="d-flex align-items-center w-100">
                <strong class="d-inline-block w-100 text-truncate">{{
                  typeName.toUpperCase()
                }}</strong>
              </div>
              <div class="row">
                <small class="text-success ml-3 d-inline-block"
                  >{{ totalItemsCount }} registros encontrados</small
                >
              </div>
            </div>
          </div>

          <div class="col-md-10 d-flex justify-content-end">
            <button
              cButton
              type="button"
              class="btn btn-primary"
              (click)="openModal()"
              *ngTemplateOutlet="liveDemo"
            >
              <i class="fas fa-plus-circle mr-2"></i>
              Crear registro
            </button>
          </div>
        </div>
      </c-card-header>
      <c-card-body>
        <form cForm class="row g-3" [formGroup]="formSearch">
          <c-col [md]="6">
            <label cLabel for="nameLabel">Nombre</label>
            <input
              type="text"
              formControlName="name"
              class="form-control"
              [ngClass]="{ 'is-invalid': submitted && f['name'].errors }"
              autoComplete="name"
              cFormControl
              placeholder="Ingrese Nombre"
            />
            <div *ngIf="submitted && f['name'].errors" class="invalid-feedback">
              <div *ngIf="f['name'].errors['required']">required</div>
              <div *ngIf="f['name'].errors['minlength']">
                name must be at least 6 characters
              </div>
              <div *ngIf="f['name'].errors['maxlength']">
                name must not exceed 20 characters
              </div>
            </div>
          </c-col>
          <c-col [md]="6">
            <label cLabel for="statusLabel">Estado</label>
            <div class="custom-select">
              <select class="form-control" id="select-search-status" formControlName="statusSelected">
                <option value="" selected>Todos</option>
                <option value="activo">Activo</option>
                <option value="inactivo">Inactivo</option>
              </select>
            </div>
            <div *ngIf="submitted && f['statusSelected'].errors" class="invalid-feedback">
              <div *ngIf="f['statusSelected'].errors['required']">Campo es Requerido (*)</div>
            </div>
          </c-col>

          <c-col [xs]="12">
            <div class="d-flex justify-content-end">
              <button cButton type="submit" (click)="createOrUpdate()">
                Buscar
              </button>
            </div>
          </c-col>
        </form>

        <table cTable *ngIf="isVisible">
          <thead>
            <tr>
              <th scope="col">Nombre</th>
              <th scope="col" *ngIf="haveInitials">Iniciales</th>
              <th scope="col">Estado</th>
              <th scope="col">Creado por:</th>
              <th scope="col">Creado en:</th>
              <th scope="col">Modificado en:</th>
              <th scope="col">Acciones</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of visibleItems()">
              <td>{{ row.description }}</td>
              <td *ngIf="haveInitials">{{ row.initial }}</td>
              <td>
                <c-badge
                  class="me-1"
                  color="{{ row.isDeleted ? 'danger' : 'success' }}"
                  >{{ row.isDeleted ? "INACTIVO" : "ACTIVO" }}</c-badge
                >
              </td>
              <td>{{ row.userCreation }}</td>
              <td>{{ row.dateCreation | date : "medium" }}</td>
              <td>{{ row.dateModification | date : "medium" }}</td>
              <td>
                <button
                  color="warning"
                  cButton
                  class="me-1"
                  shape="rounded-pill"
                  (click)="editRow(row)"
                  disabled="{{ row.isDeleted }}"
                >
                  <svg cIcon class="me-2" name="cil-pencil"></svg>
                </button>
              </td>
              <td>
                <button
                  color="{{ row.isDeleted ? 'success' : 'danger' }}"
                  cButton
                  class="me-1"
                  shape="rounded-pill"
                  (click)="enableOrDisable(row)"
                >
                  <svg
                    cIcon
                    class="me-2"
                    [name]="row.isDeleted ? 'cil-check' : 'cil-trash'"
                  ></svg>
                </button>
              </td>
            </tr>
          </tbody>
          <br />
          <app-pagination
            [totalItems]="listTypes.length"
            [itemsPerPage]="itemsPerPage"
            [currentPage]="currentPage"
            (pageChanged)="onPageChange($event)"
          ></app-pagination>
        </table>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-alert color="info" *ngIf="!isVisible">{{ message }}</c-alert>

<app-global-alerts
  *ngIf="visible"
  [visible]="visible"
  [message]="message"
></app-global-alerts>

<ng-template #liveDemo>
  <button (click)="openModal()" cButton>Crear Registro</button>
  <c-modal
    id="liveDemoModal"
    [visible]="liveDemoVisible"
    (visibleChange)="handleLiveDemoChange($event)"
  >
    <c-modal-header>
      <h5 cModalTitle>
        {{ actionRow === 0 ? "Crear" : "Actualizar" }} Registro
      </h5>
      <button (click)="closeModal()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
      <c-col xs="12">
        <c-card class="mb-4">
          <c-card-body>
            <form cForm [formGroup]="form">
              <div class="mb-3">
                <label cLabel for="nameInput">Nombre</label>
                <input
                  appOnlyLetters
                  noAutocomplete
                  maxlength="55"
                  type="text"
                  formControlName="name"
                  class="form-control"
                  [ngClass]="{ 'is-invalid': submitted && f['name'].errors }"
                  autoComplete="name"
                  cFormControl
                  placeholder="Nombre"
                />
                <div
                  *ngIf="submitted && f['name'].errors"
                  class="invalid-feedback"
                >
                  <div *ngIf="f['name'].errors['required']">
                    El campo es Requerido (*)
                  </div>
                  <div *ngIf="f['name'].errors['email']">Email is invalid</div>
                  <div *ngIf="f['name'].errors['minlength']">
                    No puede contener menos de 5 caracteres
                  </div>
                  <div *ngIf="f['name'].errors['maxlength']">
                    No puede contener mas de 50 caracteres
                  </div>
                </div>
              </div>
              <div class="mb-3" *ngIf="haveInitials">
                <label cLabel for="labelInitials">Iniciales</label>
                <input
                  type="text"
                  appOnlyLetters
                  noAutocomplete
                  formControlName="initial"
                  class="form-control"
                  [ngClass]="{ 'is-invalid': submitted && f['initial'].errors }"
                  autoComplete="initial"
                  cFormControl
                  placeholder="Iniciales"
                />
                <div
                  *ngIf="submitted && f['initial'].errors"
                  class="invalid-feedback"
                >
                  <div *ngIf="f['initial'].errors['minlength']">
                    No puede contener menos de 2 caracteres
                  </div>
                  <div *ngIf="f['initial'].errors['maxlength']">
                    No puede contener mas de 5 caracteres
                  </div>
                </div>
              </div>
            </form>
          </c-card-body>
        </c-card>
      </c-col>
    </c-modal-body>
    <c-modal-footer>
      <button (click)="closeModal()" cButton color="secondary">Cerrar</button>
      <button cButton color="primary" (click)="createOrUpdate()">
        Guardar
      </button>
    </c-modal-footer>
  </c-modal>
</ng-template>
